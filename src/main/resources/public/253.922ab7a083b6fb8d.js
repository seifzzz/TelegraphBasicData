"use strict";(self.webpackChunkWFMGIS=self.webpackChunkWFMGIS||[]).push([[253],{5253:(ge,v,r)=>{r.r(v),r.d(v,{GooglemapModule:()=>ue});var h=r(9808),_=r(3778),u=r(9783),e=r(2096),O=r(520);let f=(()=>{class o{constructor(t){this.http=t,this.URL=apiURL,this.keyMapURL=keyMap}SearchByWorkerName(t){return this.http.get(this.URL+`/data/SearchByWorkerName?EMP_Role_ID=${t}`)}SearchByWO(t){return this.http.get(this.URL+`/data/SearchByWO?WORK_ORDER_ID=${t}`)}SearchByORGROLE(t,i,s){return this.http.get(this.URL+`/data/SearchByORGROLE?ORG_ROLE=${t}&page=${i}&size=${s}`)}GetCurrentQUOTA(){return this.http.get(this.URL+"/data/GetCurrentQUOTA")}GetMaxQUOTA(){return this.http.get(this.URL+"/data/GetMaxQUOTA")}GetAddressLocation(t,i){return this.http.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${t},${i}&key=${this.keyMapURL}`)}GetAddressLocationAPI(t,i){return this.http.get(this.URL+`/Geocode/geocodeAddress?lat=${t}&lng=${i}&key=${this.keyMapURL}`)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(O.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var c=r(4182),C=r(8410),M=r(7556),S=r(7773),y=r(3787),b=r(4036),x=r(7010),w=r(845);function A(o,a){if(1&o&&(e.TgZ(0,"div")(1,"div"),e._uU(2),e.qZA()()),2&o){const t=a.$implicit;e.xp6(2),e.Oqu(t.label)}}function R(o,a){1&o&&(e.TgZ(0,"div",18),e._uU(1," Field is required."),e.qZA())}function U(o,a){if(1&o&&(e.TgZ(0,"div"),e.YNc(1,R,2,0,"div",17),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",null==t.myForm.controls.searchType||null==t.myForm.controls.searchType.errors?null:t.myForm.controls.searchType.errors.required)}}function Z(o,a){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.value," ")}}function I(o,a){1&o&&(e.TgZ(0,"div",24),e._UZ(1,"i",25),e._uU(2," Loading "),e.qZA())}function E(o,a){if(1&o&&(e.YNc(0,Z,2,1,"div",12),e.YNc(1,I,3,0,"div",23)),2&o){const t=a.$implicit;e.Q6J("ngIf","-1"!=t.valuear),e.xp6(1),e.Q6J("ngIf","-1"===t.valuear)}}const m=function(o){return{"border-danger":o}};function D(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",20),e._uU(2," ORG ROLE "),e._UZ(3,"span",9),e.qZA(),e.TgZ(4,"p-dropdown",21),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw().onChangeORGROLE(s)}),e.YNc(5,E,2,2,"ng-template",22),e.qZA()()}if(2&o){const t=e.oxw();let i;e.xp6(4),e.Q6J("options",t.OrgRole)("filter",!0)("virtualScroll",!0)("itemSize",20)("showClear",!0)("ngClass",e.VKq(6,m,(null==(i=t.myForm.get("ORG_ROLE"))?null:i.invalid)&&(null==(i=t.myForm.get("ORG_ROLE"))?null:i.errors)&&((null==(i=t.myForm.get("ORG_ROLE"))?null:i.dirty)||(null==(i=t.myForm.get("ORG_ROLE"))?null:i.touched))))}}function k(o,a){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.value," ")}}function F(o,a){1&o&&(e.TgZ(0,"div",24),e._UZ(1,"i",25),e._uU(2," Loading "),e.qZA())}function N(o,a){if(1&o&&(e.YNc(0,k,2,1,"div",12),e.YNc(1,F,3,0,"div",23)),2&o){const t=a.$implicit;e.Q6J("ngIf","-1"!=t.value),e.xp6(1),e.Q6J("ngIf","-1"===t.value)}}function L(o,a){if(1&o&&(e.TgZ(0,"div",19)(1,"label",20),e._uU(2," Worker Name "),e.TgZ(3,"span",9),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"p-dropdown",26),e.YNc(6,N,2,2,"ng-template",27),e.qZA()()),2&o){const t=e.oxw();let i;e.xp6(5),e.Q6J("virtualScroll",!0)("itemSize",20)("options",t.Workers)("filter",!0)("showClear",!0)("ngClass",e.VKq(6,m,(null==(i=t.myForm.get("all"))?null:i.invalid)&&(null==(i=t.myForm.get("all"))?null:i.errors)&&((null==(i=t.myForm.get("all"))?null:i.dirty)||(null==(i=t.myForm.get("all"))?null:i.touched))))}}function Q(o,a){if(1&o&&(e.TgZ(0,"div"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.value," ")}}function G(o,a){1&o&&(e.TgZ(0,"div",24),e._UZ(1,"i",25),e._uU(2," Loading "),e.qZA())}function W(o,a){if(1&o&&(e.YNc(0,Q,2,1,"div",12),e.YNc(1,G,3,0,"div",23)),2&o){const t=a.$implicit;e.Q6J("ngIf","-1"!=t.valuear),e.xp6(1),e.Q6J("ngIf","-1"===t.valuear)}}function J(o,a){if(1&o&&(e.TgZ(0,"div",19)(1,"label",20),e._uU(2," ORG ROLE "),e.TgZ(3,"span",9),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"p-dropdown",28),e.YNc(6,W,2,2,"ng-template",22),e.qZA()()),2&o){const t=e.oxw();let i;e.xp6(5),e.Q6J("options",t.OrgRole)("virtualScroll",!0)("itemSize",20)("filter",!0)("showClear",!0)("ngClass",e.VKq(6,m,(null==(i=t.myForm.get("all"))?null:i.invalid)&&(null==(i=t.myForm.get("all"))?null:i.errors)&&((null==(i=t.myForm.get("all"))?null:i.dirty)||(null==(i=t.myForm.get("all"))?null:i.touched))))}}function P(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",19)(1,"label",29),e._uU(2,"Work Order ID "),e.TgZ(3,"span",9),e._uU(4,"*"),e.qZA()(),e.TgZ(5,"p-inputNumber",30),e.NdJ("keyup",function(s){return e.CHM(t),e.oxw().onKeyUpWorkOrder(s)}),e.qZA()()}if(2&o){const t=e.oxw();let i;e.xp6(5),e.Q6J("min",0)("useGrouping",!1)("ngClass",e.VKq(3,m,(null==(i=t.myForm.get("all"))?null:i.invalid)&&(null==(i=t.myForm.get("all"))?null:i.errors)&&((null==(i=t.myForm.get("all"))?null:i.dirty)||(null==(i=t.myForm.get("all"))?null:i.touched))))}}function q(o,a){if(1&o&&e._UZ(0,"p-button",31,32),2&o){const t=e.oxw();e.Q6J("disabled",t.myForm.invalid||!t.canSearch())}}function B(o,a){if(1&o&&e._UZ(0,"p-button",31,32),2&o){const t=e.oxw();e.Q6J("disabled",t.disablebutton)}}const Y=function(){return{"margin-left":".5em"}};let z=(()=>{class o{constructor(t,i,s,n){this.dataApi=t,this.lookupApi=i,this.auth=s,this.messageService=n,this.getResponse=new e.vpe,this.checkType={label:"",value:""},this.doneWork=!1,this.disablebutton=!0,this.showSecondButton=!1,this.onChangeORGROLE=(l=this.searchObj)=>{var d;if(this.searchObj=l,null==l&&(this.Workers=this.WorkersNoFilter),"-1"!=(null===(d=this.Workers[0])||void 0===d?void 0:d.id)&&null!=l)if(this.Workers=this.WorkersNoFilter,null!==l&&1==this.doneWork){let p=this.WorkersNoFilter.filter(me=>me.dependcode==l.value);this.Workers=p}else this.Workers=this.WorkersNoFilter},this.onChangesearchType=l=>{var d;this.checkType=l,this.WORK_ORDER_ID=null,null===(d=this.myForm.get("all"))||void 0===d||d.reset(),null!==l?(1==l.value&&(this.getOUByOrgRole(),this.getWorkersByOrgRole(),this.checkType={label:"",value:"1"},this.showSecondButton=!1),2==l.value&&(this.checkType={label:"",value:"2"},this.showSecondButton=!0),3==l.value&&(this.getOUByOrgRole(),this.checkType={label:"",value:"3"},this.showSecondButton=!1)):this.checkType={label:"",value:""}},this.GetCurrentQUOTA(),this.GetMaxQUOTA()}ngOnChanges(t){}ngOnInit(){this.Workers=[{valuear:void 0,dependcode:"-1",value:"-1",id:"-1"}],this.OrgRole=[{value:void 0,valuear:"-1"}],this.WORK_ORDER_ID=null,this.items=[{label:"Worker Name",value:"1"},{label:"Worker Order ID",value:"2"},{label:"ORG ROLE",value:"3"}],this.myForm=new c.cw({searchType:new c.NI("",[c.kI.required]),ORG_ROLE:new c.NI(""),all:new c.NI("",[c.kI.required])})}getOUByOrgRole(){this.lookupApi.getOUByOrgRole().subscribe(t=>{this.OrgRole=200==t.statusCode?t.body:[],this.loado=!0})}getWorkersByOrgRole(){this.lookupApi.getWorkersByOrgRole().subscribe(t=>{200==t.statusCode?(this.Workers=t.body,this.WorkersNoFilter=t.body,this.doneWork=!0,this.onChangeORGROLE()):this.Workers=[]})}onKeyUpWorkOrder(t){this.disablebutton=""===t.target.value||"2"!=this.checkType.value}canSearch(){return!(null==this.myForm.controls.all.value.valuear||null==this.myForm.controls.all.value.value)}onSubmit(){localStorage.setItem("searchTypes",JSON.stringify("")),localStorage.setItem("searchTypesValue",JSON.stringify("")),this.getResponse.emit([]),this.loadingpage=!0,this.searchTypes=this.myForm.value.searchType,localStorage.setItem("searchTypes",JSON.stringify(this.searchTypes)),localStorage.setItem("searchTypesValue",JSON.stringify(this.myForm.value.all));var t=this.myForm.value.searchType.value,i=this.myForm.value.all;1==t&&(this.getWorkersByOrgRole(),this.getOUByOrgRole(),this.locations=[],this.dataApi.SearchByWorkerName(i.id).subscribe(s=>{200==s.statusCode?(this.loadingpage=!1,this.locations=s.body,this.getResponse.emit(this.locations),this.GetCurrentQUOTA()):(this.locations=[],this.getResponse.emit(this.locations),this.GetCurrentQUOTA())},s=>{var n,l;this.locations=[],this.getResponse.emit(this.locations),this.GetCurrentQUOTA(),(null===(n=null==s?void 0:s.error)||void 0===n?void 0:n.clientMessage)?this.messageService.add({severity:"error",summary:"Error",detail:`${null===(l=null==s?void 0:s.error)||void 0===l?void 0:l.clientMessage}`}):this.messageService.add({severity:"error",summary:"Error",detail:"Unknown Error"})})),2==t&&(this.locations=[],this.dataApi.SearchByWO(i).subscribe(s=>{200==s.statusCode?(this.locations=s.body,this.getResponse.emit(this.locations),this.GetCurrentQUOTA()):(this.locations=[],this.getResponse.emit(this.locations),this.GetCurrentQUOTA())},s=>{var n,l;(null===(n=null==s?void 0:s.error)||void 0===n?void 0:n.clientMessage)?this.messageService.add({severity:"error",summary:"Error",detail:`${null===(l=null==s?void 0:s.error)||void 0===l?void 0:l.clientMessage}`}):this.messageService.add({severity:"error",summary:"Error",detail:"Unknown Error"}),this.locations=[],this.getResponse.emit(this.locations),this.GetCurrentQUOTA()})),3==t&&(this.locations=[],this.dataApi.SearchByORGROLE(i.value,0,100).subscribe(s=>{200==s.statusCode?(this.locations=s.body,localStorage.setItem("searchTotalItems",s.developerMessage),this.getResponse.emit(this.locations),this.GetCurrentQUOTA()):(this.locations=[],this.getResponse.emit(this.locations),this.GetCurrentQUOTA())},s=>{var n,l;(null===(n=null==s?void 0:s.error)||void 0===n?void 0:n.clientMessage)?this.messageService.add({severity:"error",summary:"Error",detail:`${null===(l=null==s?void 0:s.error)||void 0===l?void 0:l.clientMessage}`}):this.messageService.add({severity:"error",summary:"Error",detail:"Unknown Error"}),this.locations=[],this.getResponse.emit(this.locations),this.GetCurrentQUOTA()}))}reset(){this.myForm.reset(),this.getResponse.emit("reset"),this.checkType.value=""}ngOnDestroy(){var t,i;null===(t=this.sub1)||void 0===t||t.unsubscribe(),null===(i=this.sub2)||void 0===i||i.unsubscribe()}GetCurrentQUOTA(){this.sub2=this.dataApi.GetCurrentQUOTA().subscribe(t=>{200==t.statusCode&&(this.CurrentQUOTA=t.body)},t=>{var i,s;(null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.clientMessage)?this.messageService.add({severity:"error",summary:"Error",detail:`${null===(s=null==t?void 0:t.error)||void 0===s?void 0:s.clientMessage}`}):this.messageService.add({severity:"error",summary:"Error",detail:"Unknown Error"})})}GetMaxQUOTA(){this.sub1=this.dataApi.GetMaxQUOTA().subscribe(t=>{200==t.statusCode&&(this.MaxQUOTA=t.body)},t=>{var i,s;(null===(i=null==t?void 0:t.error)||void 0===i?void 0:i.clientMessage)?this.messageService.add({severity:"error",summary:"Error",detail:`${null===(s=null==t?void 0:t.error)||void 0===s?void 0:s.clientMessage}`}):this.messageService.add({severity:"error",summary:"Error",detail:"Unknown Error"})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(f),e.Y36(C.K),e.Y36(M.e),e.Y36(u.ez))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-search"]],outputs:{getResponse:"getResponse"},features:[e.TTD],decls:25,vars:21,consts:[["position","top-left"],[3,"formGroup","ngSubmit"],[1,"p-1"],["header","Search",3,"transitionOptions","selected"],[1,"quota"],["id","search",1,"formControID"],[1,"row","search"],[1,"col-2"],["for","searchType"],[1,"text-danger"],["inputId","searchType","optionLabel","label","formControlName","searchType","filterBy","label","placeholder","Select Search Type",3,"options","filter","showClear","ngClass","onChange"],["pTemplate","selectedItem"],[4,"ngIf"],["class","col-3",4,"ngIf"],[1,"actions"],["label","Search","type","submit","icon","pi pi-search","id","search","styleClass","p-button-success p-search btnNew",3,"disabled",4,"ngIf"],["label","Reset","type","button","icon","pi pi-refresh","styleClass","p-button-secondary btnNew ","data-dismiss","modal",3,"click"],["class","form-text text-danger mt-1",4,"ngIf"],[1,"form-text","text-danger","mt-1"],[1,"col-3"],["for","userName"],["inputId","ORG_ROLE","optionLabel","value","formControlName","ORG_ROLE","filterBy","value","placeholder","Select ORG ROLE",3,"options","filter","virtualScroll","itemSize","showClear","ngClass","ngModelChange"],["pTemplate","ORG_ROLE"],["style","margin-left: 40%;",4,"ngIf"],[2,"margin-left","40%"],[1,"pi","pi-spin","pi-spinner","text-center"],["inputId","EMP_Role_ID","optionLabel","valuear","formControlName","all","filterBy","valuear","placeholder","Select EMP Role",3,"virtualScroll","itemSize","options","filter","showClear","ngClass"],["pTemplate","EMP_Role_ID"],["inputId","ORG_ROLE","optionLabel","value","formControlName","all","filterBy","value","placeholder","Select ORG ROLE",3,"options","virtualScroll","itemSize","filter","showClear","ngClass"],["for","WORK_ORDER_ID"],["formControlName","all","id","WORK_ORDER_ID",3,"min","useGrouping","ngClass","keyup"],["label","Search","type","submit","icon","pi pi-search","id","search","styleClass","p-button-success p-search btnNew",3,"disabled"],["search",""]],template:function(t,i){if(1&t&&(e._UZ(0,"p-toast",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(2,"div",2)(3,"p-accordion")(4,"p-accordionTab",3)(5,"div",4),e._uU(6),e.qZA(),e.TgZ(7,"div",5)(8,"div",6)(9,"div",7)(10,"label",8),e._uU(11,"Search By "),e.TgZ(12,"span",9),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"p-dropdown",10),e.NdJ("onChange",function(n){return i.onChangesearchType(n.value)}),e.YNc(15,A,3,1,"ng-template",11),e.qZA(),e.YNc(16,U,2,1,"div",12),e.qZA(),e.YNc(17,D,6,8,"div",13),e.YNc(18,L,7,8,"div",13),e.YNc(19,J,7,8,"div",13),e.YNc(20,P,6,5,"div",13),e.TgZ(21,"div",14),e.YNc(22,q,2,1,"p-button",15),e.YNc(23,B,2,1,"p-button",15),e.TgZ(24,"p-button",16),e.NdJ("click",function(){return i.reset()}),e.qZA()()()()()()()()),2&t){let s,n;e.xp6(1),e.Q6J("formGroup",i.myForm),e.xp6(3),e.Q6J("transitionOptions","100ms")("selected",!0),e.xp6(2),e.AsE(" (Current ",null==i.CurrentQUOTA?null:i.CurrentQUOTA.split("=")[(null==i.CurrentQUOTA?null:i.CurrentQUOTA.split("=").length)-1]," : Max ",null==i.MaxQUOTA?null:i.MaxQUOTA.split("=")[(null==i.MaxQUOTA?null:i.MaxQUOTA.split("=").length)-1]," ) QUOTA "),e.xp6(8),e.Q6J("options",i.items)("filter",!0)("showClear",!0)("ngClass",e.VKq(18,m,(null==(s=i.myForm.get("searchType"))?null:s.invalid)&&(null==(s=i.myForm.get("searchType"))?null:s.errors)&&((null==(s=i.myForm.get("searchType"))?null:s.dirty)||(null==(s=i.myForm.get("searchType"))?null:s.touched)))),e.xp6(2),e.Q6J("ngIf",(null==(n=i.myForm.get("searchType"))?null:n.invalid)&&(null==(n=i.myForm.get("searchType"))?null:n.errors)&&((null==(n=i.myForm.get("searchType"))?null:n.dirty)||(null==(n=i.myForm.get("searchType"))?null:n.touched))),e.xp6(1),e.Q6J("ngIf","1"==i.checkType.value),e.xp6(1),e.Q6J("ngIf","1"==i.checkType.value),e.xp6(1),e.Q6J("ngIf","3"==i.checkType.value),e.xp6(1),e.Q6J("ngIf","2"==i.checkType.value),e.xp6(2),e.Q6J("ngIf",!i.showSecondButton),e.xp6(1),e.Q6J("ngIf",i.showSecondButton),e.xp6(1),e.Akn(e.DdM(20,Y))}},directives:[S.FN,c._Y,c.JL,c.sg,y.UQ,y.US,b.Lt,c.JJ,c.u,h.mk,u.jx,h.O5,x.Rn,w.zx],styles:[".search[_ngcontent-%COMP%]   .col-3[_ngcontent-%COMP%], .search[_ngcontent-%COMP%]   .col-2[_ngcontent-%COMP%]{margin-bottom:5px}.search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;color:#64748b;margin-left:2px;font-size:11px!important}.actions[_ngcontent-%COMP%]{float:right;margin-right:7px;margin-top:30px}.actions[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{margin-left:2px}.hiddenInput[_ngcontent-%COMP%]{height:0px!important;visibility:hidden;padding:0;float:left;margin-top:-10px!important}.formControID[_ngcontent-%COMP%]   .p-inputtext[_ngcontent-%COMP%]{width:-webkit-fill-available}.quota[_ngcontent-%COMP%]{text-align:right;font-size:14px;font-weight:600;margin-bottom:-20px}"]}),o})();var g=r(6697),$=r(1424),K=r(4132);const j=["mySearch"];function V(o,a){if(1&o&&(e.TgZ(0,"div",7),e._UZ(1,"br"),e.TgZ(2,"span",8),e._uU(3),e.qZA()()),2&o){const t=e.oxw();e.xp6(3),e.Oqu(t.showMessageNotActive)}}function H(o,a){1&o&&e._UZ(0,"div",10)}function X(o,a){if(1&o&&(e.TgZ(0,"div",7),e._UZ(1,"br"),e.YNc(2,H,1,0,"div",9),e.qZA()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",-1!==t.counterDrawMappagenation||t.totalRecords>0)}}const ee=function(){return{standalone:!0}};function te(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",19)(1,"span",20),e._UZ(2,"i",21),e.TgZ(3,"input",22,23),e.NdJ("ngModelChange",function(s){return e.CHM(t),e.oxw(2).h=s})("input",function(){e.CHM(t);const s=e.MAs(4);return e.oxw(),e.MAs(2).filterGlobal(s.value,"contains")}),e.qZA()()()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModelOptions",e.DdM(2,ee))("ngModel",t.h)}}function ie(o,a){1&o&&(e.TgZ(0,"tr")(1,"th",24)(2,"div",25),e._uU(3," Worker Name "),e._UZ(4,"p-sortIcon",26),e.qZA()(),e.TgZ(5,"th",27)(6,"div",25),e._uU(7," last Modified Date "),e._UZ(8,"p-sortIcon",28),e.qZA()(),e.TgZ(9,"th",29)(10,"div",25),e._uU(11," Emp ROLE ID "),e._UZ(12,"p-sortIcon",30),e.qZA()(),e.TgZ(13,"th",31)(14,"div",25),e._uU(15," STATUS "),e._UZ(16,"p-sortIcon",32),e.qZA()()(),e.TgZ(17,"tr")(18,"th"),e._UZ(19,"p-columnFilter",33),e.qZA(),e.TgZ(20,"th"),e._UZ(21,"p-columnFilter",34),e.qZA(),e.TgZ(22,"th"),e._UZ(23,"p-columnFilter",35),e.qZA(),e.TgZ(24,"th"),e._UZ(25,"p-columnFilter",36),e.qZA()())}const oe=function(o,a){return{active:o,inactive:a}};function se(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"tr",37),e.NdJ("click",function(){const s=e.CHM(t),n=s.$implicit,l=s.rowIndex;return e.oxw(2).selectedRow(n,l)}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.ALo(5,"date"),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td")(9,"span",38),e._uU(10),e.qZA()()()}if(2&o){const t=a.$implicit,i=a.rowIndex;e.Q6J("pSelectableRow",t)("pSelectableRowIndex",i),e.xp6(2),e.Oqu(t.worker_NAME),e.xp6(2),e.Oqu(e.xi3(5,7,t.last_MODIFIED_DATE,"medium")),e.xp6(3),e.Oqu(t.emp_ROLE_ID),e.xp6(2),e.Q6J("ngClass",e.WLB(10,oe,"Active Location"==t.worker_STATUS,"InActive Location"==t.worker_STATUS)),e.xp6(1),e.hij(" ",t.worker_STATUS," ")}}function ne(o,a){1&o&&(e.TgZ(0,"tr")(1,"td",39)(2,"h6",40),e._uU(3,"No Data Found"),e.qZA()()())}const T=function(){return[5,10,25,50,100,500]};function ae(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"span")(1,"span",42),e._uU(2),e.qZA(),e.TgZ(3,"p-paginator",43,44),e.NdJ("onPageChange",function(s){return e.CHM(t),e.oxw(3).paginate(s)}),e.qZA()()}if(2&o){const t=e.oxw(3);e.xp6(2),e.lnq(" Showing ",t.first," to ",t.last," of ",t.totalRecords," entries "),e.xp6(1),e.Q6J("first",t.first)("rows",t.totalRow)("totalRecords",t.totalRecords)("rowsPerPageOptions",e.DdM(7,T))}}function le(o,a){if(1&o&&e.YNc(0,ae,5,8,"span",41),2&o){const t=e.oxw(2);e.Q6J("ngIf",!t.isPaginator)}}const re=function(){return["worker_ID","worker_NAME","longitude","latitude","imei","last_MODIFIED_DATE","emp_ROLE_ID","org_ROLE"]};function pe(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"p-table",12,13),e.NdJ("selectionChange",function(s){return e.CHM(t),e.oxw().selectedR=s}),e.YNc(3,te,5,3,"ng-template",14),e.YNc(4,ie,26,0,"ng-template",15),e.YNc(5,se,11,13,"ng-template",16),e.YNc(6,ne,4,0,"ng-template",17),e.YNc(7,le,1,1,"ng-template",18),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("value",t.dataDetails)("columns",t.selectedColumns)("rows",100)("showCurrentPageReport",!0)("scrollable",!1)("rowsPerPageOptions",e.DdM(11,T))("loading",t.loading)("selection",t.selectedR)("paginator",t.isPaginator)("globalFilterFields",e.DdM(12,re))("metaKeySelection",!0)}}const ce=[{path:"",component:(()=>{class o{constructor(t,i,s){this.messageService=t,this.router=i,this.dataApi=s,this.first=0,this.last=0,this.totalRecords=0,this.totalRow=0,this.hiddenMap=!1,this.hiddentable=!1,this.showMessage=!1,this.counterlocations=0,this.locations=[{lat:0,lng:0}],this.isPaginator=!0}getLocations(t){var i,s,n,l;this.isPaginator=!0,this.counterlocations++,1==this.counterlocations?this.loading=!0:2==this.counterlocations&&(this.loading=!1,this.counterlocations=0),this.showMessageNotActive="",this.showMessage=!1;let d=localStorage.getItem("searchTypes");if(null!==d&&""!==d&&(this.searchTypes=JSON.parse(d)),1==(null===(i=this.searchTypes)||void 0===i?void 0:i.value)?this.labelMessage="FME name":2==(null===(s=this.searchTypes)||void 0===s?void 0:s.value)?this.labelMessage="WO":3==(null===(n=this.searchTypes)||void 0===n?void 0:n.value)&&(this.labelMessage=" "),this.counterDrawMap=0,this.dataDetails=t,"reset"==t)this.locations=[],this.hiddenMap=!0,window.history.go();else{this.locations=[],this.hiddentable=!0,3==(null===(l=this.searchTypes)||void 0===l?void 0:l.value)&&(this.isPaginator=!1,this.totalRecords=localStorage.getItem("searchTotalItems"),this.first=1,this.last=this.dataDetails.length,this.totalRow=this.dataDetails.length);for(let p=0;p<this.dataDetails.length;p++)null!==this.dataDetails[p].latitude&&null!==this.dataDetails[p].longitude&&this.counterDrawMap++,this.locations.push({lat:parseFloat(this.dataDetails[p].latitude),lng:parseFloat(this.dataDetails[p].longitude)});0!==this.dataDetails.length?this.counterDrawMap>0?(this.addressF=" ",1==this.searchTypes.value||2==this.searchTypes.value?this.dataApi.GetAddressLocation(this.dataDetails[0].latitude,this.dataDetails[0].longitude).subscribe(p=>{p.results.length>0&&(this.addressF=p.results[0].formatted_address),setTimeout(()=>{this.drawMaps()},0)},p=>{this.messageService.add({severity:"warn",summary:"Warning",detail:"Something went wrong  while getting address location"}),setTimeout(()=>{this.drawMaps()},0)}):3==this.searchTypes.value&&setTimeout(()=>{this.drawMaps()},0),this.showMessage=!1):(this.showMessageNotActive=this.labelMessage+"InActive For Long Time",this.showMessage=!0,this.hiddenMap=!0):(this.hiddenMap=!0,this.hiddentable=!0)}}ngOnInit(){this.loading=!1}drawMaps(){this.loading=!1,this.allFormateAddress=[],this.counterlocations=0,this.map=new google.maps.Map(document.getElementById("map"),{center:{lat:26.820553,lng:30.802498},zoom:3}),this.infoWindow=new google.maps.InfoWindow({content:"",disableAutoPan:!0}),this.markers=this.locations.map((s,n)=>{"InActive Location"==this.dataDetails[n].worker_STATUS&&(this.color="red"),"Active Location"==this.dataDetails[n].worker_STATUS&&(this.color="green");var l=this.addressF,d='<h6 style="font-size: 13px;">Worker Name : '+this.dataDetails[n].worker_NAME+'</h6><h6 style="font-size: 13px;">Last Modified Date : '+(0,h.p6)(this.dataDetails[n].last_MODIFIED_DATE,"medium","en_US")+'</h6><h6 style="font-size: 13px;">Emp ROLE ID : '+this.dataDetails[n].emp_ROLE_ID+'</h6><h6 style="font-size: 13px;">Org ROLE : '+this.dataDetails[n].org_ROLE+'</h6<br><h6 style="font-size: 13px;">Worker Status : <span style="color:'+this.color+'"> '+this.dataDetails[n].worker_STATUS+"</span></h6>",p=new google.maps.Marker({position:s,label:{text:l,color:"#a33",fontSize:"13px",fontWeight:"bold",marginTop:"70px",className:"marker-label"},icon:"assets/images/usermarker-"+this.color+".png"});return p.addListener("click",()=>{this.infoWindow.setContent(d),this.infoWindow.open(this.map,p)}),p});var t=new google.maps.LatLngBounds;for(let s=0;s<this.locations.length;s++)"NaN"!==this.locations[s].lat.toString()&&t.extend(new google.maps.LatLng(this.locations[s].lat,this.locations[s].lng));this.map.fitBounds(t),new MarkerClusterer(this.map,this.markers)}selectedRow(t,i){var s=this.markers[i].getPosition(),n=new google.maps.LatLng(s.lat()+.02,s.lng());this.map.panTo(n),this.infoWindow&&this.infoWindow.close();var l='<h6 style="font-size: 13px;">Worker Name : '+(null==t?void 0:t.worker_NAME)+'</h6><h6 style="font-size: 13px;">Last Modified Date : '+(0,h.p6)(null==t?void 0:t.last_MODIFIED_DATE,"medium","en_US")+'</h6><h6 style="font-size: 13px;">Emp ROLE ID : '+(null==t?void 0:t.emp_ROLE_ID)+'</h6><h6 style="font-size: 13px;">Org ROLE : '+(null==t?void 0:t.org_ROLE)+'</h6<br><h6 style="font-size: 13px;">Worker Status : <span style="color:'+this.color+'"> '+(null==t?void 0:t.worker_STATUS)+" </span></h6<br>";this.infoWindow.setContent(l),this.infoWindow.setPosition(this.markers[i].getPosition()),this.infoWindow.open(this.map,this.markers[i]),this.map.setZoom(100),this.map.setCenter(this.markers[i].getPosition())}paginate(t){this.first=t.first+1,this.last=(t.page+1)*t.rows,t.page==t.pageCount-1&&(this.last=this.totalRecords);let i=localStorage.getItem("searchTypesValue");null!==i&&(this.searchTypesValue=JSON.parse(i)),this.loading=!0,this.counterDrawMappagenation=0,this.locations=[],this.dataApi.SearchByORGROLE(this.searchTypesValue.value,t.page,t.rows).subscribe(s=>{var n;if(200==s.statusCode){this.loading=!1,this.dataDetails=s.body;for(let l=0;l<this.dataDetails.length;l++)null!==this.dataDetails[l].latitude&&null!==this.dataDetails[l].longitude&&this.counterDrawMappagenation++,this.locations.push({lat:parseFloat(this.dataDetails[l].latitude),lng:parseFloat(this.dataDetails[l].longitude)});this.counterDrawMappagenation>0?(null===(n=this.mySearch)||void 0===n||n.GetCurrentQUOTA(),setTimeout(()=>{this.drawMaps()},0)):0==this.counterDrawMappagenation&&(this.locations=[],this.counterDrawMappagenation=-1,this.totalRecords=0)}},s=>{var n,l;(null===(n=null==s?void 0:s.error)||void 0===n?void 0:n.clientMessage)?this.messageService.add({severity:"error",summary:"Error",detail:`${null===(l=null==s?void 0:s.error)||void 0===l?void 0:l.clientMessage}`}):this.messageService.add({severity:"error",summary:"Error",detail:"Unknown Error"})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(u.ez),e.Y36(_.F0),e.Y36(f))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-map"]],viewQuery:function(t,i){if(1&t&&e.Gf(j,5),2&t){let s;e.iGM(s=e.CRH())&&(i.mySearch=s.first)}},features:[e._Bn([u.ez])],decls:10,vars:3,consts:[[1,"row","col-12"],[1,"col-12",2,"padding","0 !important","margin","0 !important"],[3,"getResponse"],["mySearch",""],["class","col-8",4,"ngIf"],[1,"col-4",2,"padding","0"],["style","margin: 5px; margin-top: 22px; border-left: 1px solid #dee2e6; border-right: 1px solid #dee2e6;",4,"ngIf"],[1,"col-8"],[1,"error-message"],["id","map","style","height: 90%;",4,"ngIf"],["id","map",2,"height","90%"],[2,"margin","5px","margin-top","22px","border-left","1px solid #dee2e6","border-right","1px solid #dee2e6"],["id","dt1","sortMode","multiple","scrollHeight","400px","styleClass","p-datatable-sm","styleClass","p-datatable-sm p-datatable-gridlines","selectionMode","single","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","responsiveLayout","scroll","dataKey","id",3,"value","columns","rows","showCurrentPageReport","scrollable","rowsPerPageOptions","loading","selection","paginator","globalFilterFields","metaKeySelection","selectionChange"],["dt1",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pTemplate","summary"],[1,"table-header",2,"height","25px"],[1,"p-input-icon-left","searchtable"],[1,"pi","pi-search"],["pInputText","","type","text","ngModel","","placeholder","Search keyword",3,"ngModelOptions","ngModel","ngModelChange","input"],["inVal","ngModel"],["pSortableColumn","worker_NAME"],[1,"p-d-flex","p-jc-between","p-ai-center"],["field","worker_NAME"],["pSortableColumn","last_MODIFIED_DATE"],["field","last_MODIFIED_DATE"],["pSortableColumn","emp_ROLE_ID"],["field","emp_ROLE_ID"],["pSortableColumn","worker_STATUS"],["field","worker_STATUS"],["type","text","field","worker_NAME"],["type","text","field","last_MODIFIED_DATE"],["type","text","field","emp_ROLE_ID"],["type","text","field","worker_STATUS"],[3,"pSelectableRow","pSelectableRowIndex","click"],[3,"ngClass"],["colspan","9"],[1,"emptymessage"],[4,"ngIf"],[1,"paginatorShow"],["id","manual-paginator",3,"first","rows","totalRecords","rowsPerPageOptions","onPageChange"],["paginator",""]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"app-search",2,3),e.NdJ("getResponse",function(n){return i.getLocations(n)}),e.qZA()(),e._UZ(4,"br"),e.YNc(5,V,4,1,"div",4),e.YNc(6,X,3,1,"div",4),e._UZ(7,"br"),e.TgZ(8,"div",5),e.YNc(9,pe,8,13,"div",6),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngIf",i.showMessage),e.xp6(1),e.Q6J("ngIf",!i.showMessage),e.xp6(3),e.Q6J("ngIf",i.hiddentable))},directives:[z,h.O5,g.iA,u.jx,c.Fj,$.o,c.JJ,c.On,g.lQ,g.fz,g.xl,g.Ei,h.mk,K.D],pipes:[h.uU],styles:[".error-message[_ngcontent-%COMP%]{text-align:center;color:#a33;margin-left:25%}.inactive[_ngcontent-%COMP%]{color:red}.active[_ngcontent-%COMP%]{color:green}"]}),o})()}];let de=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[_.Bz.forChild(ce)],_.Bz]}),o})();var he=r(3218);let ue=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[h.ez,de,he.m]]}),o})()}}]);