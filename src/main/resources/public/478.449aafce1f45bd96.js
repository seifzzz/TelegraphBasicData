"use strict";(self.webpackChunkWFMGIS=self.webpackChunkWFMGIS||[]).push([[478],{5478:(T,p,l)=>{l.r(p),l.d(p,{AuthModule:()=>P});var d=l(9808),m=l(3778),a=l(4182),e=l(2096),h=l(7556),v=l(9783),f=l(2160),b=l(1874),w=l(7773),y=l(1424);function Z(n,g){1&n&&(e.TgZ(0,"div",31),e._uU(1," Username is required. "),e.qZA())}function M(n,g){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Z,2,0,"div",30),e.qZA()),2&n){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.loginForm.controls.username||null==o.loginForm.controls.username.errors?null:o.loginForm.controls.username.errors.required)}}function S(n,g){1&n&&(e.TgZ(0,"div",31),e._uU(1," Password is required. "),e.qZA())}function C(n,g){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,S,2,0,"div",30),e.qZA()),2&n){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",null==o.loginForm.controls.password||null==o.loginForm.controls.password.errors?null:o.loginForm.controls.password.errors.required)}}const c=function(n){return{"border-danger":n}},x=[{path:"",component:(()=>{class n{constructor(o,t,i,r){this.authService=o,this.router=t,this.messageService=i,this.cookie=r,this.typePass="password",this.routing1=["/","","/error"],this.routing2=["home","audit","tracking"]}ngOnInit(){this.loginForm=new a.cw({username:new a.NI("",[a.kI.required]),password:new a.NI("",[a.kI.required])}),this.cookie.check("login")?this.router.navigate(["/home"]):(this.itemsModule=[{label:"All Modules",items:[{label:"itemsModule1",icon:"pi pi-external-link",url:"/"},{label:"itemsModule2",icon:"pi pi-external-link",url:"/"}]}],this.getHref(),this.automaticLogin())}onSubmit(){localStorage.clear(),this.cookie.deleteAll(),this.loginPage(this.loginForm.value)}automaticLogin(){this.authService.getCheckLogout.subscribe(o=>{1==o&&(this.objempty={username:"",password:""},this.loginPage(this.objempty))})}loginPage(o){let t=this.encryptpassword(o);this.authService.login(t).subscribe(i=>{this.getSessionParams(t,i)},i=>{var r,s;(null===(s=null===(r=null==i?void 0:i.error)||void 0===r?void 0:r.clientMessage)||void 0===s?void 0:s.includes("locked"))?(this.showErrorMessage=i.error.clientMessage,this.messageService.add({severity:"error",summary:"Error",detail:this.showErrorMessage})):""!==o.username&&""!==o.password&&(this.showErrorMessage="Invalid username OR password",this.messageService.add({severity:"error",summary:"Error",detail:this.showErrorMessage}))})}getSessionParams(o,t){this.authService.getSessionParams(o).subscribe(i=>{localStorage.setItem("userModules",JSON.stringify(t.userModules)),localStorage.setItem("authorities",JSON.stringify(t.authorities)),localStorage.setItem("username",t.username);let r=this.authService.getPrevURL();this.cookie.set("login","true"),console.log("previousUrl.value"),console.log(r.value),"/"!==r.value&&""!==r.value&&"/error"!==r.value&&this.routing2.includes(r.value)?this.router.navigate([r.value]):this.router.navigate(["/home"]),this.authService.setcheckLogin(!0),this.messageService.add({severity:"success",summary:"Success",detail:"Login successfully"})},i=>{console.error(i),this.messageService.add({severity:"error",summary:"Error",detail:"Something went wrong"})})}getHref(){let o=String(window.location.href).split(":"),r=o[0]+":"+o[1]+":"+o[2].split("/")[0]+"/";return this.cookie.set("Host",r),r}encryptpassword(o){let t=l(7206),i=o.password,r=t.enc.Latin1.parse("MTS@SECRET#KEYMA"),s=t.enc.Latin1.parse("AMYEK#TERCES@STM"),u=t.AES.encrypt(i,r,{iv:s,mode:t.mode.CBC,padding:t.pad.ZeroPadding});return{username:o.username,password:u.toString()}}toggleShow(){this.typePass="password"===this.typePass?"text":"password"}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(h.e),e.Y36(m.F0),e.Y36(v.ez),e.Y36(f.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-loginpage"]],decls:47,vars:14,consts:[[1,"header"],[1,"title"],[1,"ml-3",2,"display","none"],["type","button","label","",1,"btn","btn-default","dark-blue",3,"click"],[1,"pi","pi-bars"],[3,"popup","model"],["menu",""],["position","top-left"],[1,"homepage","vh-100"],[1,"container","pt-3"],[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-6"],[1,"card","shadow-2-strong"],[1,"card-body"],["src","assets/images/hiveworxlogo.png","title","LOGO",1,"logo"],[3,"formGroup","ngSubmit"],[1,"p-fluid","p-grid"],["for","inputusername"],[1,"p-input-icon-left"],[1,"pi","pi-user"],["type","text","name","username","formControlName","username","pInputText","","placeholder","username",3,"ngClass"],[4,"ngIf"],["for","inputPassword"],[1,"flex-pass"],[1,"pi","pi-lock"],["name","password","formControlName","password","pInputText","","placeholder","Password",2,"padding-left","35px","margin-right","-5px",3,"type","ngClass"],[1,"mt-4","mb-4"],[1,"mt-2","mb-3"],["type","submit",1,"btn","btn-default","full-width","dark-blue",3,"disabled"],[1,"form-text","text-danger","mt-1","text-center"],["class","form-text text-danger mt-1",4,"ngIf"],[1,"form-text","text-danger","mt-1"]],template:function(o,t){if(1&o){const i=e.EpF();e.TgZ(0,"div",0)(1,"p",1),e._uU(2,"WFM GIS Portal"),e.qZA(),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(s){return e.CHM(i),e.MAs(7).toggle(s)}),e._UZ(5,"i",4),e.qZA(),e._UZ(6,"p-menu",5,6),e.qZA()(),e._UZ(8,"p-toast",7),e.TgZ(9,"section",8)(10,"div",9)(11,"div",10)(12,"div",11),e._UZ(13,"br"),e.TgZ(14,"div",12)(15,"div",13),e._UZ(16,"br")(17,"img",14)(18,"br")(19,"br"),e.TgZ(20,"form",15),e.NdJ("ngSubmit",function(){return t.onSubmit()}),e.TgZ(21,"div",16)(22,"label",17),e._uU(23," Username * "),e.qZA(),e.TgZ(24,"div")(25,"span",18),e._UZ(26,"i",19)(27,"input",20),e.qZA()(),e.YNc(28,M,2,1,"div",21),e.qZA(),e._UZ(29,"br"),e.TgZ(30,"div",16)(31,"label",22),e._uU(32," Password * "),e.qZA(),e.TgZ(33,"div")(34,"span",23),e._UZ(35,"i",24)(36,"input",25),e.qZA()(),e.YNc(37,C,2,1,"div",21),e.qZA(),e._UZ(38,"br")(39,"hr",26),e.TgZ(40,"div",27)(41,"button",28),e._uU(42," Login "),e.qZA()(),e._UZ(43,"br"),e.TgZ(44,"div",29),e._uU(45),e.qZA()()()(),e._UZ(46,"br"),e.qZA()()()()}if(2&o){let i,r,s,u;e.xp6(6),e.Q6J("popup",!0)("model",t.itemsModule),e.xp6(14),e.Q6J("formGroup",t.loginForm),e.xp6(7),e.Q6J("ngClass",e.VKq(10,c,(null==(i=t.loginForm.get("username"))?null:i.invalid)&&(null==(i=t.loginForm.get("username"))?null:i.errors)&&((null==(i=t.loginForm.get("username"))?null:i.dirty)||(null==(i=t.loginForm.get("username"))?null:i.touched)))),e.xp6(1),e.Q6J("ngIf",(null==(r=t.loginForm.get("username"))?null:r.invalid)&&(null==(r=t.loginForm.get("username"))?null:r.errors)&&((null==(r=t.loginForm.get("username"))?null:r.dirty)||(null==(r=t.loginForm.get("username"))?null:r.touched))),e.xp6(8),e.Q6J("type","password")("ngClass",e.VKq(12,c,(null==(s=t.loginForm.get("password"))?null:s.invalid)&&(null==(s=t.loginForm.get("password"))?null:s.errors)&&((null==(s=t.loginForm.get("password"))?null:s.dirty)||(null==(s=t.loginForm.get("password"))?null:s.touched)))),e.xp6(1),e.Q6J("ngIf",(null==(u=t.loginForm.get("password"))?null:u.invalid)&&(null==(u=t.loginForm.get("password"))?null:u.errors)&&((null==(u=t.loginForm.get("password"))?null:u.dirty)||(null==(u=t.loginForm.get("password"))?null:u.touched))),e.xp6(4),e.Q6J("disabled",t.loginForm.invalid),e.xp6(4),e.hij(" ",t.showErrorMessage," ")}},directives:[b.v2,w.FN,a._Y,a.JL,a.sg,a.Fj,a.JJ,a.u,y.o,d.mk,d.O5],styles:[".header[_ngcontent-%COMP%]{background:#9f3636;height:63px}.title[_ngcontent-%COMP%]{text-align:center;font-size:24px;color:#fff;padding:13px}.logo[_ngcontent-%COMP%]{margin-left:15%;width:75%;margin-bottom:-30px;margin-top:-25px}.homepage[_ngcontent-%COMP%]{background-color:#ddd;background-repeat:no-repeat;background-position:center}.logoimage[_ngcontent-%COMP%]{width:240px;padding:0 10px;margin-left:27%}.shadow-2-strong[_ngcontent-%COMP%]{border-radius:.25rem;box-shadow:#0000003d 0 3px 8px;border:0}.full-width[_ngcontent-%COMP%]{width:100%;border-radius:.4rem}.btn[_ngcontent-%COMP%]:not(:disabled):not(.disabled){color:#fff!important}.btn[_ngcontent-%COMP%]:disabled{background:#717170!important}.text-danger[_ngcontent-%COMP%]{font-size:13px}.flex-pass[_ngcontent-%COMP%]{display:flex;position:relative;width:100%;align-items:center;justify-content:center;z-index:5}.pi-lock[_ngcontent-%COMP%]{margin-right:-30px;z-index:30;position:absolute;top:14px;left:14px}"]}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[m.Bz.forChild(x)],m.Bz]}),n})();var A=l(3218);let P=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[d.ez,F,A.m]]}),n})()}}]);